<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Herramienta de Auditoría de Madurez Operacional y Digital - UpKaizen</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutral & Subtle Green -->
    <!-- Application Structure Plan: A two-column dashboard SPA. Left column has tabbed navigation for audit sections (Data, Planning, Manufacturing, Culture). Right column is a sticky summary panel with a dynamic radar chart and a list of identified opportunities. This structure allows users to fill the audit and see real-time results without scrolling, enhancing usability and engagement. -->
    <!-- Visualization & Content Choices: Questions are presented in cards with interactive 1-5 scoring inputs. The primary visualization is a Chart.js Radar Chart in the summary panel, chosen to effectively compare the maturity levels of the four distinct audit areas. A dynamic list of "Opportunities" is generated by filtering for low-scoring questions (score <= 3), providing an immediate, actionable takeaway for the user. All interactions are handled with vanilla JS for speed and simplicity. NO SVG/Mermaid used. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f9fa;
        }
        .chart-container {
            position: relative;
            height: 300px;
            max-height: 400px;
            width: 100%;
            max-width: 400px;
            margin: auto;
        }
        .score-radio-label {
            transition: all 0.2s ease-in-out;
        }
        .score-radio:checked + .score-radio-label {
            transform: scale(1.1);
            box-shadow: 0 4px 14px 0 rgba(0, 118, 255, 0.39);
        }
        .score-1:checked + .score-radio-label { background-color: #ef4444; border-color: #ef4444; color: white; }
        .score-2:checked + .score-radio-label { background-color: #f97316; border-color: #f97316; color: white; }
        .score-3:checked + .score-radio-label { background-color: #eab308; border-color: #eab308; color: white; }
        .score-4:checked + .score-radio-label { background-color: #84cc16; border-color: #84cc16; color: white; }
        .score-5:checked + .score-radio-label { background-color: #22c55e; border-color: #22c55e; color: white; }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto max-w-7xl p-4 sm:p-6 lg:p-8">
        
        <header class="mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-900">Auditoría de Madurez Operacional y Digital</h1>
            <p class="mt-2 text-lg text-gray-600">Una herramienta de diagnóstico por <span class="font-semibold text-green-600">UpKaizen</span></p>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-3 lg:gap-8">

            <div class="lg:col-span-2">
                <div class="mb-6">
                    <div id="tabs-container" class="flex flex-wrap border-b border-gray-200">
                    </div>
                </div>

                <div id="questions-container" class="space-y-6">
                </div>
            </div>

            <aside class="lg:col-span-1 mt-8 lg:mt-0">
                <div class="sticky top-8 bg-white p-6 rounded-2xl shadow-lg">
                    <h2 class="text-2xl font-bold mb-4">Resumen de Resultados</h2>
                    
                    <div class="text-center mb-6">
                        <p class="text-gray-600">Puntuación General de Madurez</p>
                        <p id="total-score" class="text-5xl font-bold text-green-600">0.0</p>
                    </div>

                    <div class="chart-container mb-6">
                        <canvas id="maturityChart"></canvas>
                    </div>

                    <div>
                        <h3 class="text-xl font-semibold mb-3">Áreas de Oportunidad Clave</h3>
                        <div id="opportunities-list" class="space-y-2 text-sm max-h-60 overflow-y-auto pr-2">
                            <p class="text-gray-500">Completa la auditoría para ver las oportunidades.</p>
                        </div>
                    </div>
                </div>
            </aside>

        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const auditData = {
                'A': { id: 'A', name: 'Datos', questions: [
                    { id: 'A1', text: 'Disponibilidad de Datos en Tiempo Real de procesos clave (producción, inventario, calidad).' },
                    { id: 'A2', text: 'Centralización y Accesibilidad de Datos para análisis (ej. en un ERP, MES, Data Lake).' },
                    { id: 'A3', text: 'Calidad y Consistencia de Datos Maestros (productos, materiales, proveedores).' },
                    { id: 'A4', text: 'Uso de Dashboards y Reportes Interactivos (ej. Power BI) para la toma de decisiones.' }
                ], scores: {} },
                'B': { id: 'B', name: 'Planificación', questions: [
                    { id: 'B1', text: 'Precisión y metodología del pronóstico de demanda (estadísticos, ML/IA).' },
                    { id: 'B2', text: 'Proceso de S&OP (Sales & Operations Planning) formal y colaborativo.' },
                    { id: 'B3', text: 'Uso de metodologías o herramientas para optimizar los niveles de inventario.' },
                    { id: 'B4', text: 'Gestión de la variabilidad y resiliencia de la cadena de suministro.' }
                ], scores: {} },
                'C': { id: 'C', name: 'Manufactura', questions: [
                    { id: 'C1', text: 'Mapeo y estandarización de procesos de producción.' },
                    { id: 'C2', text: 'Identificación y gestión proactiva de cuellos de botella en las líneas.' },
                    { id: 'C3', text: 'Nivel de automatización de tareas repetitivas en planta (ej. RPA, robótica).' },
                    { id: 'C4', text: 'Monitoreo sistemático del rendimiento de equipos (OEE).' },
                    { id: 'C5', text: 'Transición hacia un mantenimiento predictivo basado en datos (ej. IoT, IA).' }
                ], scores: {} },
                'D': { id: 'D', name: 'Cultura', questions: [
                    { id: 'D1', text: 'Capacitación regular del personal clave en herramientas digitales y análisis.' },
                    { id: 'D2', text: 'Liderazgo que promueve activamente la digitalización y gestiona el cambio.' },
                    { id: 'D3', text: 'Cultura organizacional que fomenta la experimentación y la mejora continua.' }
                ], scores: {} }
            };

            const scoreLabels = {
                1: 'Inicial', 2: 'En Desarrollo', 3: 'Definido', 4: 'Gestionado', 5: 'Optimizado'
            };

            const tabsContainer = document.getElementById('tabs-container');
            const questionsContainer = document.getElementById('questions-container');
            let activeTab = 'A';

            function renderTabs() {
                tabsContainer.innerHTML = '';
                Object.values(auditData).forEach(section => {
                    const isActive = section.id === activeTab;
                    const tabClasses = isActive
                        ? 'border-green-500 text-green-600'
                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300';
                    const tab = document.createElement('button');
                    tab.className = `py-4 px-1 text-center border-b-2 font-medium text-sm sm:text-base sm:px-4 focus:outline-none ${tabClasses}`;
                    tab.textContent = section.name;
                    tab.dataset.tab = section.id;
                    tab.addEventListener('click', () => {
                        activeTab = section.id;
                        render();
                    });
                    tabsContainer.appendChild(tab);
                });
            }
            
            function renderQuestions() {
                questionsContainer.innerHTML = '';
                const section = auditData[activeTab];
                section.questions.forEach(q => {
                    const card = document.createElement('div');
                    card.id = `question-${q.id}`;
                    card.className = 'bg-white p-6 rounded-xl shadow-md transition-all hover:shadow-lg';
                    
                    let scoreButtonsHtml = '';
                    for (let i = 1; i <= 5; i++) {
                        const isChecked = section.scores[q.id] === i;
                        scoreButtonsHtml += `
                            <div>
                                <input type="radio" name="score-${q.id}" id="score-${q.id}-${i}" value="${i}" class="sr-only score-radio score-${i}" ${isChecked ? 'checked' : ''}>
                                <label for="score-${q.id}-${i}" class="score-radio-label w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center rounded-full border-2 border-gray-300 cursor-pointer font-bold text-lg hover:bg-gray-100">
                                    ${i}
                                </label>
                            </div>
                        `;
                    }

                    card.innerHTML = `
                        <p class="font-semibold text-gray-800 mb-4">${q.id}. ${q.text}</p>
                        <div class="flex justify-around items-center space-x-2 mb-4">
                            ${scoreButtonsHtml}
                        </div>
                        <div class="mt-4">
                            <label for="comment-${q.id}" class="block text-sm font-medium text-gray-500 mb-1">Comentarios / Oportunidad:</label>
                            <textarea id="comment-${q.id}" rows="2" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500" placeholder="Añadir observaciones..."></textarea>
                        </div>
                    `;
                    questionsContainer.appendChild(card);

                    card.querySelectorAll(`input[name="score-${q.id}"]`).forEach(radio => {
                        radio.addEventListener('change', (e) => {
                            section.scores[q.id] = parseInt(e.target.value);
                            updateResults();
                        });
                    });
                     const commentArea = card.querySelector(`#comment-${q.id}`);
                    if(section.scores[q.id]?.comment) {
                       commentArea.value = section.scores[q.id].comment;
                    }
                    commentArea.addEventListener('input', (e) => {
                        if(section.scores[q.id]) {
                            section.scores[q.id].comment = e.target.value;
                        }
                    });
                });
            }

            const ctx = document.getElementById('maturityChart').getContext('2d');
            const maturityChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: Object.values(auditData).map(s => s.name),
                    datasets: [{
                        label: 'Nivel de Madurez',
                        data: [0, 0, 0, 0],
                        backgroundColor: 'rgba(34, 197, 94, 0.2)',
                        borderColor: 'rgba(34, 197, 94, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(34, 197, 94, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(34, 197, 94, 1)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(0, 0, 0, 0.1)' },
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            pointLabels: { font: { size: 14, weight: '600' } },
                            suggestedMin: 0,
                            suggestedMax: 5,
                            ticks: {
                                stepSize: 1,
                                backdropColor: 'rgba(255, 255, 255, 0.75)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.r !== null) {
                                        label += context.parsed.r.toFixed(1) + ' - ' + (scoreLabels[Math.round(context.parsed.r)] || '');
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });

            function updateResults() {
                const sectionScores = {};
                let totalScore = 0;
                let scoredQuestions = 0;
                const opportunities = [];

                Object.values(auditData).forEach(section => {
                    let sectionTotal = 0;
                    const sectionScoredQuestions = Object.values(section.scores).filter(s => s).length;
                    
                    Object.entries(section.scores).forEach(([qid, score]) => {
                        if (score) {
                           sectionTotal += score;
                           totalScore += score;
                           scoredQuestions++;
                           if(score <= 3) {
                               const questionText = section.questions.find(q => q.id === qid).text;
                               opportunities.push({id: qid, text: questionText, score: score });
                           }
                        }
                    });

                    sectionScores[section.id] = sectionScoredQuestions > 0 ? (sectionTotal / sectionScoredQuestions) : 0;
                });

                const overallScore = scoredQuestions > 0 ? (totalScore / scoredQuestions).toFixed(1) : '0.0';
                document.getElementById('total-score').textContent = overallScore;
                
                maturityChart.data.datasets[0].data = Object.values(sectionScores);
                maturityChart.update();

                const opportunitiesList = document.getElementById('opportunities-list');
                opportunitiesList.innerHTML = '';
                if(opportunities.length > 0) {
                    opportunities.sort((a,b) => a.score - b.score);
                    opportunities.forEach(opp => {
                        const item = document.createElement('a');
                        item.href = `#question-${opp.id}`;
                        item.className = 'block bg-gray-100 p-2 rounded-lg hover:bg-yellow-100 transition-colors';
                        item.innerHTML = `
                            <div class="flex items-center justify-between">
                                <span><span class="font-bold">${opp.id}:</span> ${opp.text}</span>
                                <span class="font-bold text-white text-xs rounded-full h-6 w-6 flex items-center justify-center score-${opp.score}-bg">${opp.score}</span>
                            </div>
                        `;
                        opportunitiesList.appendChild(item);
                         const bgClass = `score-${opp.score}-bg`;
                         const scoreSpan = item.querySelector('.score-span');
                         if(scoreSpan) scoreSpan.classList.add(bgClass);
                         item.querySelector('span:last-child').classList.add(`bg-${['red','orange','yellow','lime','green'][opp.score-1]}-500`);
                    });
                } else {
                    opportunitiesList.innerHTML = '<p class="text-gray-500">¡Gran trabajo! No se detectan áreas de oportunidad de baja madurez.</p>';
                }

            }

            function render() {
                renderTabs();
                renderQuestions();
            }

            render();
            updateResults();
        });
    </script>
</body>
</html>
